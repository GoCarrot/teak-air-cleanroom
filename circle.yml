machine:
  xcode:
    version: 9.2
  environment:
    ADOBE_AIR_HOME: /usr/local/share/adobe-air-sdk
    LC_ALL: en_US.UTF-8
    LANG: en_US.UTF-8
test:
  override:
  - rake package:download build:air build:android build:ios
dependencies:
  pre:
  - gem install bundler
  - bundle install
  - ./setup
  cache_directories:
    - ~/Library/Caches/Homebrew/
checkout:
  post:
    - git fetch --tags
deployment:
  prod:
    branch: master
    commands:
      - aws s3 cp teak-air-cleanroom.ipa s3://teak-build-artifacts/air-cleanroom/teak-air-cleanroom-`cat TEAK_VERSION`.ipa --acl public-read
      - aws s3 cp teak-air-cleanroom.apk s3://teak-build-artifacts/air-cleanroom/teak-air-cleanroom-`cat TEAK_VERSION`.apk --acl public-read
